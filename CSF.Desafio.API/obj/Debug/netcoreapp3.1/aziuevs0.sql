IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;

GO

CREATE TABLE [TB_CIDADE] (
    [ID] int NOT NULL IDENTITY,
    [NOME] nvarchar(100) NOT NULL,
    [ESTADO] nvarchar(2) NOT NULL,
    CONSTRAINT [PK_TB_CIDADE] PRIMARY KEY ([ID])
);

GO

CREATE TABLE [TB_CLIENTE] (
    [ID] int NOT NULL IDENTITY,
    [NOME] nvarchar(150) NOT NULL,
    [RG] nvarchar(20) NOT NULL,
    [CPF] nvarchar(20) NOT NULL,
    [DATA_NASCIMENTO] datetime2 NOT NULL,
    [TELEFONE] nvarchar(20) NOT NULL,
    [EMAIL] nvarchar(150) NULL,
    [COD_EMPRESA] int NOT NULL,
    CONSTRAINT [PK_TB_CLIENTE] PRIMARY KEY ([ID])
);

GO

CREATE TABLE [TB_ENDERECO] (
    [ID] int NOT NULL IDENTITY,
    [RUA] nvarchar(255) NOT NULL,
    [BAIRRO] nvarchar(50) NOT NULL,
    [NUMERO] nvarchar(50) NOT NULL,
    [COMPLEMENTO] nvarchar(100) NOT NULL,
    [CEP] nvarchar(10) NOT NULL,
    [TIPO_ENDERECO] int NOT NULL,
    [TB_CIDADE_ID] int NOT NULL,
    CONSTRAINT [PK_TB_ENDERECO] PRIMARY KEY ([ID]),
    CONSTRAINT [FK_TB_ENDERECO_TB_CIDADE_TB_CIDADE_ID] FOREIGN KEY ([TB_CIDADE_ID]) REFERENCES [TB_CIDADE] ([ID]) ON DELETE CASCADE
);

GO

CREATE TABLE [TB_CLIENTE_ENDERECO] (
    [TB_CLIENTE_ID] int NOT NULL,
    [TB_ENDERECO_ID] int NOT NULL,
    [ID] int NOT NULL,
    CONSTRAINT [PK_TB_CLIENTE_ENDERECO] PRIMARY KEY ([TB_CLIENTE_ID], [TB_ENDERECO_ID]),
    CONSTRAINT [FK_TB_CLIENTE_ENDERECO_TB_CLIENTE_TB_CLIENTE_ID] FOREIGN KEY ([TB_CLIENTE_ID]) REFERENCES [TB_CLIENTE] ([ID]) ON DELETE CASCADE,
    CONSTRAINT [FK_TB_CLIENTE_ENDERECO_TB_ENDERECO_TB_ENDERECO_ID] FOREIGN KEY ([TB_ENDERECO_ID]) REFERENCES [TB_ENDERECO] ([ID]) ON DELETE CASCADE
);

GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'ID', N'ESTADO', N'NOME') AND [object_id] = OBJECT_ID(N'[TB_CIDADE]'))
    SET IDENTITY_INSERT [TB_CIDADE] ON;
INSERT INTO [TB_CIDADE] ([ID], [ESTADO], [NOME])
VALUES (1, N'RS', N'Santa Cruz do Sul'),
(2, N'RS', N'Vera Cruz');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'ID', N'ESTADO', N'NOME') AND [object_id] = OBJECT_ID(N'[TB_CIDADE]'))
    SET IDENTITY_INSERT [TB_CIDADE] OFF;

GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'ID', N'COD_EMPRESA', N'CPF', N'DATA_NASCIMENTO', N'EMAIL', N'NOME', N'RG', N'TELEFONE') AND [object_id] = OBJECT_ID(N'[TB_CLIENTE]'))
    SET IDENTITY_INSERT [TB_CLIENTE] ON;
INSERT INTO [TB_CLIENTE] ([ID], [COD_EMPRESA], [CPF], [DATA_NASCIMENTO], [EMAIL], [NOME], [RG], [TELEFONE])
VALUES (1, 1, N'01552764095', '1650-07-23T00:00:00.0000000', N'rafaelv_s@hotmail.com', N'Rafael Vieira Suarez', N'6096800117', N'51999708050'),
(2, 1, N'00460801040', '1987-07-30T00:00:00.0000000', N'caroline_splett@gmail.com', N'Caroline Seer Splett', N'6096800618', N'51996013891');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'ID', N'COD_EMPRESA', N'CPF', N'DATA_NASCIMENTO', N'EMAIL', N'NOME', N'RG', N'TELEFONE') AND [object_id] = OBJECT_ID(N'[TB_CLIENTE]'))
    SET IDENTITY_INSERT [TB_CLIENTE] OFF;

GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'ID', N'BAIRRO', N'CEP', N'TB_CIDADE_ID', N'COMPLEMENTO', N'NUMERO', N'RUA', N'TIPO_ENDERECO') AND [object_id] = OBJECT_ID(N'[TB_ENDERECO]'))
    SET IDENTITY_INSERT [TB_ENDERECO] ON;
INSERT INTO [TB_ENDERECO] ([ID], [BAIRRO], [CEP], [TB_CIDADE_ID], [COMPLEMENTO], [NUMERO], [RUA], [TIPO_ENDERECO])
VALUES (1, N'Ana Nery', N'96835422', 1, N'150 m', N'3322', N'Euclides Kliemann', 1);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'ID', N'BAIRRO', N'CEP', N'TB_CIDADE_ID', N'COMPLEMENTO', N'NUMERO', N'RUA', N'TIPO_ENDERECO') AND [object_id] = OBJECT_ID(N'[TB_ENDERECO]'))
    SET IDENTITY_INSERT [TB_ENDERECO] OFF;

GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'ID', N'BAIRRO', N'CEP', N'TB_CIDADE_ID', N'COMPLEMENTO', N'NUMERO', N'RUA', N'TIPO_ENDERECO') AND [object_id] = OBJECT_ID(N'[TB_ENDERECO]'))
    SET IDENTITY_INSERT [TB_ENDERECO] ON;
INSERT INTO [TB_ENDERECO] ([ID], [BAIRRO], [CEP], [TB_CIDADE_ID], [COMPLEMENTO], [NUMERO], [RUA], [TIPO_ENDERECO])
VALUES (2, N'Centro', N'96835344', 2, N'456 A', N'3322', N'Euclides Kliemann', 2);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'ID', N'BAIRRO', N'CEP', N'TB_CIDADE_ID', N'COMPLEMENTO', N'NUMERO', N'RUA', N'TIPO_ENDERECO') AND [object_id] = OBJECT_ID(N'[TB_ENDERECO]'))
    SET IDENTITY_INSERT [TB_ENDERECO] OFF;

GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'TB_CLIENTE_ID', N'TB_ENDERECO_ID', N'ID') AND [object_id] = OBJECT_ID(N'[TB_CLIENTE_ENDERECO]'))
    SET IDENTITY_INSERT [TB_CLIENTE_ENDERECO] ON;
INSERT INTO [TB_CLIENTE_ENDERECO] ([TB_CLIENTE_ID], [TB_ENDERECO_ID], [ID])
VALUES (1, 1, 1);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'TB_CLIENTE_ID', N'TB_ENDERECO_ID', N'ID') AND [object_id] = OBJECT_ID(N'[TB_CLIENTE_ENDERECO]'))
    SET IDENTITY_INSERT [TB_CLIENTE_ENDERECO] OFF;

GO

IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'TB_CLIENTE_ID', N'TB_ENDERECO_ID', N'ID') AND [object_id] = OBJECT_ID(N'[TB_CLIENTE_ENDERECO]'))
    SET IDENTITY_INSERT [TB_CLIENTE_ENDERECO] ON;
INSERT INTO [TB_CLIENTE_ENDERECO] ([TB_CLIENTE_ID], [TB_ENDERECO_ID], [ID])
VALUES (2, 2, 2);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'TB_CLIENTE_ID', N'TB_ENDERECO_ID', N'ID') AND [object_id] = OBJECT_ID(N'[TB_CLIENTE_ENDERECO]'))
    SET IDENTITY_INSERT [TB_CLIENTE_ENDERECO] OFF;

GO

CREATE INDEX [IX_TB_CLIENTE_ENDERECO_TB_ENDERECO_ID] ON [TB_CLIENTE_ENDERECO] ([TB_ENDERECO_ID]);

GO

CREATE INDEX [IX_TB_ENDERECO_TB_CIDADE_ID] ON [TB_ENDERECO] ([TB_CIDADE_ID]);

GO

INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20230525221510_inicial', N'3.1.8');

GO

